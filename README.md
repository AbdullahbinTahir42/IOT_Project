# ‚ö° VoltSense - IoT Smart Power Monitor

**VoltSense** is an end-to-end IoT solution designed to monitor power consumption and environmental data in real-time. It features a custom hardware node based on the **ESP32**, a high-speed **FastAPI** backend, and a responsive **React** dashboard for data visualization.
![frontend](https://github.com/user-attachments/assets/10a0e58b-a6fd-45db-9977-7777f8ff62cd)
## üöÄ Features

* **Real-Time Monitoring:** Live tracking of Voltage (V), Current (mA), Power (mW), and Temperature (¬∞C).
* **Data Persistence:** Historical data storage using a cloud-based **Supabase (PostgreSQL)** database.
* **Interactive Dashboard:** Dynamic charts and gauges built with React and Recharts.
* **Energy Analytics:** continuously calculates power usage trends from connected loads (Fan/LED).
* **Wireless Data Transmission:** Efficient JSON data streaming over Wi-Fi.

---

## üõ†Ô∏è Tech Stack

### **Hardware**
* **Microcontroller:** ESP32 Dev Module
* **Sensors:** INA219 (Voltage/Current), DHT11 (Temperature/Humidity)
* **Power Management:** LM2596 Buck Converter
* **Load:** 5V DC Fan, LED (Used as dummy loads for power measurement)

### **Software**
* **Firmware:** C++ (PlatformIO)
* **Backend:** Python (FastAPI, Uvicorn)
* **Frontend:** React.js (Vite, Tailwind CSS, Recharts)
* **Database:** Supabase (PostgreSQL)

---

## üîå Circuit Diagram & Pinout

### **Pin Configuration**
| Component | ESP32 Pin | Description |
| :--- | :--- | :--- |
| **INA219 SDA** | GPIO 21 | I2C Data Line |
| **INA219 SCL** | GPIO 22 | I2C Clock Line |
| **DHT11 Data** | GPIO 18 | Temperature Sensor |

### **Wiring Overview**
* **Power:** 9V Battery -> LM2596 (Set to 5.5V) -> ESP32 VIN & INA219 Vin+.
* **Grounds:** Common ground connected between ESP32, Battery, and Sensors.
* **Load Connection:**
    * **Positive:** Fan/LED Red wire -> INA219 Vin-.
    * **Negative:** Fan/LED Black wire -> Common Ground.

---

## ‚öôÔ∏è Installation & Setup

### **1. Database Setup (Supabase)**
1.  Create a project at [Supabase.com](https://supabase.com).
2.  Go to the **SQL Editor** and run this command to create the table:
    ```sql
    create table sensor_readings (
      id bigint generated by default as identity primary key,
      created_at timestamp with time zone default timezone('utc'::text, now()) not null,
      voltage float not null,
      current float not null,
      power float not null,
      temperature float not null,
      humidity float not null,
      source text not null
    );
    ```

### **2. Backend Setup (FastAPI)**

Create a virtual environment and install dependencies:
python -m venv venv
# Windows:
venv\Scripts\activate
# Mac/Linux:
source venv/bin/activate
uv add fastapi uvicorn supabase pydantic python-dotenv

Create a .env file in the backend folder:

SUPABASE_URL="YOUR_SUPABASE_PROJECT_URL"
SUPABASE_KEY="YOUR_SUPABASE_SERVICE_ROLE_KEY"
pip install fastapi uvicorn supabase pydantic python-dotenv

Navigate to the backend folder:
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
Run the server:
cd smart_monitor_backend
uvicorn main:app --host 0.0.0.0 --port 8000 --reload


3. Frontend Setup (React)

Navigate to the frontend folder:
cd smart_monitor_frontend

Install dependencies:
npm install

Create a .env file in the frontend folder:

VITE_SUPABASE_URL="YOUR_SUPABASE_PROJECT_URL"
VITE_SUPABASE_ANON_KEY="YOUR_SUPABASE_ANON_KEY"

Run the dashboard:
npm run dev

4. Firmware Setup (PlatformIO)
Open the smart_monitor_Pio folder in VS Code (with PlatformIO extension installed).

Update src/main.cpp with your Wi-Fi credentials:

const char* ssid = "YOUR_HOTSPOT_NAME";
const char* password = "YOUR_HOTSPOT_PASSWORD";
// Use the IP of your laptop's Hotspot Adapter (e.g., 192.168.137.1)
String serverName = "[http://192.168.137.1:8000/readings/](http://192.168.137.1:8000/readings/)";
Connect ESP32 via USB.

Click Upload (Right arrow icon in bottom bar).

‚ö†Ô∏è Troubleshooting
1. Error -1 / Connection Refused
Cause: The ESP32 cannot reach the laptop's backend server. This often happens on University/Enterprise Wi-Fi due to "Client Isolation".

Fix: Use a Mobile Hotspot from your laptop or phone. Connect both the laptop and ESP32 to this hotspot. Ensure the IP address in main.cpp matches your laptop's Hotspot IP (check via ipconfig on Windows).

2. Dashboard Shows Old Data
Cause: Backend sorting logic.

Fix: Ensure the backend query sorts by id (descending) to fetch the newest rows first.


üë§ Author
Abdullah Tahir

LinkedIn: https://www.linkedin.com/in/abdullah-tahir-23ntucs1004/
